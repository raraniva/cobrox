{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load filter_functions %}
{% load static %}
{% load humanize %}
{% block main %}
<div class="row">
<div class="col-lg-8">
    <div class="ibox ">
        <div class="ibox-title ibox-heading">
            <h3><strong><i class="fa fa-money"></i> Detalle de créditos</strong></h3>
        </div>
        <div class="ibox-content inspinia-timeline">
            {% for obj in object_list %}
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-4 date">

                            <i class="fa fa-calendar"></i></i>
                            <small class="text-navy">Inicio: &nbsp;{{ obj.fechaini |date:'d-b-Y ' }}</small><br>
                            <small class="text-navy">Vencimiento: &nbsp;{{ obj.fechaven |date:'d-b-Y ' }}</small><br>
                            <small class="text-navy">Días: &nbsp;{{ obj.qtydiascuota }}</small>
                            <br/>
                            <small class="text-navy">[ Otorgado: $ {{ obj.montootorgado|intcomma }} ] </small> <br>
                            <small class="text-navy"> [ Interés:  {{ obj.interespct }}% ] </small> <br>
                            <img class="rounded-circle"  src="{% static 'images/nogen-avatar.png' %}"  width="100%" style="width:40px"/>

                            {% revigenciaestadocredito obj.saldopendiente obj.fechaven obj.estadocredito as liked_by_user_flag %}
                            {% if liked_by_user_flag == 0  %}
                                <span class="badge badge-info"><i class="fa fa-gear"></i> Vigente </span>
                            {% elif liked_by_user_flag  == 1  %}
                                <span class="badge badge-warning"><i class="fa fa-warning"></i> Vencido </span>
                            {% else  %}
                                <span class="badge badge-primary"><i class="fa fa-check-circle"></i> Cancelado </span>
                            {% endif %}
                            <br>
                            <small class="text-navy"> [ <strong> {{ obj.get_tipocredito_display }} </strong> ] </small> <br><br>

                        </div>
                        <div class="col content">

                            <p><strong>Cuotas Pendientes:</strong>  {{ obj.cuotaspendientes }}  &nbsp;&nbsp;
                            Cuotas Pagadas: {{  obj.cuotaspagadas  }} &nbsp;&nbsp;&nbsp;
                                {% if obj.tipocredito == 0 %}
                                    <span class="badge badge-primary">C</span>&nbsp;{{ obj.get_tipocredito_display }}
                                {% else %}
                                    <span class="badge badge-success">R</span>&nbsp;{{ obj.get_tipocredito_display }}
                                {% endif %}

                            </p>

                            <div class="media-body text-right ">
                                <p> Cuota: <strong>$ {{ obj.totalcuota|intcomma   }} </strong> &nbsp;&nbsp;
                                    Capital: $ {{ obj.capitalcuota|intcomma  }}&nbsp;&nbsp;
                                    Interés: $ {{ obj.interescuota|intcomma  }}
                                 </p>


                                <p> Interes Total: $ {{ obj.interestotal|intcomma  }}  </p>
                                <p> Capital Total: $ {{ obj.montootorgado|intcomma  }}  </p>
                                <p> Total: $ {{ obj.montoyinterestotal|intcomma  }}  </p>

                            </div>
                            <div class="media-body text-left ">

                                <p><strong> Saldo Total Pendiente: $  {{ obj.saldopendiente|intcomma  }}
                                     </strong></p>


                            </div>


                        </div>
                    </div>
                </div>
            {% empty %}
            <small>Cliente no posee créditos asociados</small>
            {% endfor %}
        </div>
    </div>
</div>
<div class="col-lg-4">
    <div class="ibox">
        <div class="ibox-content">
            <div id="contact-4" class="tab-pane">
                <div class="row m-b-lg">
                    <div class="col-lg-4 text-center">
                        <h2>{{ view.cliente.nombre }} </h2>

                        <div class="m-b-sm">

                            <img class="rounded-circle"  src="{% static 'images/nogen-avatar.png' %}"  width="100%" style="width:40px"/>
                        </div>
                    </div>
                    <div class="col-lg-8">
                        <strong>
                            General
                        </strong>
                        <p>
                            <p><i class="fa fa-map-marker"></i> {{ view.cliente.direccion }}, {{ view.cliente.zona }}</p>
                            <p><i class="fa fa-drivers-license"></i>  {{ view.cliente.dui }}</p>
                            <p><i class="fa fa-vcard"></i>  {{ view.cliente.nit }}</p>
                            <p><i class="fa fa-phone"></i>  {{ view.cliente.telefono }}</p>
                            <p><i class="fa fa-tag"></i>  {{ view.cliente.tipo_cliente }}</p>
                            {% if view.cliente.codigo %}
                                <p><i class="fa fa-archive"></i>  {{ view.cliente.codigo }}</p>
                            {% endif %}
                        </p>
                        <a href="{% url 'cobrox:CreditoAdd' pk=view.cliente.id %}"  >
                        <span class="badge badge-primary"><h4> <i class="fa fa-plus-circle"></i> Ir Registrar Crédito</h4></span>
                         </a>
                            <p> </p>
                        <a href="{% url 'cobrox:ClienteList' %}"  >
                        <span class="badge badge-primary"><h4> <i class="fa fa-backward"></i> Regresar a Clientes</h4></span>
                         </a>
                        <p>

                                {% if view.cliente.observacion %}
                                <p><div class="alert alert-warning alert-dismissable">
                                            <strong><i class="fa fa-comments"></i> Observación: </strong>
                                            <p>{{ view.cliente.observacion }}</p>
                                </div></p>
                                {% endif %}

                         </p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

{% endblock %}

